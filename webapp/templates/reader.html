<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="static/styles/slider_style_sheet.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/foznt-awesome.min.css">
{% extends "base.html" %}

{% block content %}
    <body>
        <div class="w3-row-padding w3-center w3-margin-top">
           <div class="w3-center">
             <div class="w3-card w3-container" style="min-height:200px">
                 <h4>{{filename}}</h4><br>
                 <h1 id="sequence" style='text-align: center' style="display:none"></h1>
             </div>
           </div>
       </div>
       <form style='text-align: center' class="w3-margin-top" method='POST' action='/reader'>
           <div class="w3-center">
               <div class="w3-bar w3-center" style="width:50%">
                   <button class="w3-bar-item w3-button w3-xlarge w3-black w3-hover-dark-grey w3-hover-text-amber"
                            onclick="restart_file(); return false;" style="width:33.3%">
                       <h3>&#10226; &nbsp; Reset</h3>
                   </button>
                   <button class="w3-bar-item w3-button w3-xlarge w3-black w3-hover-dark-grey w3-hover-text-amber"
                            onclick="pause(); return false;" style="width:33.3%" >
                      <h3>&#9612;&#9612; &nbsp; Pause</h3>
                   </button>
                   <button class="w3-bar-item w3-button w3-xlarge w3-black w3-hover-dark-grey w3-hover-text-amber"
                            onclick="play(); return false;" style="width:33.3%">
                       <h3>&#9658 &nbsp; Play</h3>
                   </button>
                </div>
                <div class="center">
                    <div class="slidecontainer">
                        <input id="slide" class="slider" type="range" min="100" max="300" step="50" value="200">
                    </div>
                </div>
                <div class="w3-bar w3-center" style="width:50%">
                    <button class="w3-bar-item w3-button w3-xlarge w3-dark-grey w3-hover-grey w3-hover-text-black"
                            onclick="change_speed(100); return false;" style="width:20%" >
                        <h3>100</h3>
                    </button>
                    <button class="w3-bar-item w3-button w3-xlarge w3-dark-grey w3-hover-grey w3-hover-text-black"
                            onclick="change_speed(150); return false;" style="width:20%" >
                       <h3>150</h3>
                    </button>
                    <button class="w3-bar-item w3-button w3-xlarge w3-dark-grey w3-hover-grey w3-hover-text-black"
                            onclick="change_speed(200); return false;" style="width:20%" >
                        <h3>200</h3>
                    </button>
                    <button class="w3-bar-item w3-button w3-xlarge w3-dark-grey w3-hover-grey w3-hover-text-black"
                            onclick="change_speed(250); return false;" style="width:20%" >
                       <h3>250</h3>
                    </button>
                    <button class="w3-bar-item w3-button w3-xlarge w3-dark-grey w3-hover-grey w3-hover-text-black"
                            onclick="change_speed(300); return false;" style="width:20%" >
                        <h3>300</h3>
                    </button>
                 </div>
             </div>
       </form>
       <script>
           function sleep(ms) {
               return new Promise(resolve => setTimeout(resolve, ms));
           }
           let index = 0
           var example = {{ list|tojson }};
           let speed = (60 / 200) * 1000
           const slider = document.getElementById('slide');

           function restart_file() {
              index = 0
            }

           function pause() {
              speed = 300000
              console.log('pause btn', speed)
            }

            function play() {
               speed = (60 / document.getElementById("slide").value) * 1000
               console.log('play btn', speed)
               updateword()
             }

           function change_speed(val) {
              document.getElementById("slide").value = val;
              speed = (60 / val) * 1000
              // console.log('change_speed btn', speed)
            }

           slider.addEventListener('change', (e) => {
               speed = (60 / e.target.value) * 1000
               // console.log('event listener', speed)
           })

           const updateword = async() => {
               if (index == example.length){
                   index = 0
               }
               // console.log('update word', speed)
               await sleep(speed)
               document.getElementById("sequence").innerHTML = example[index];
               index++
               updateword()
           }
           updateword()
       </script>
   </body>
{% endblock %}
